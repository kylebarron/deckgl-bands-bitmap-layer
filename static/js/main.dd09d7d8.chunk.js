(this.webpackJsonpsite=this.webpackJsonpsite||[]).push([[0],{110:function(e,t){},144:function(e,t,a){e.exports=a(156)},149:function(e,t,a){},152:function(e,t){},156:function(e,t,a){"use strict";a.r(t);var n,r=a(9),o=a.n(r),i=a(125),s=a.n(i),l=(a(149),a(14)),c=a.n(l),u=a(26),d=a(2),p=a(1),b=a(90),m=a(6),g=a(171),f=a(173),v=a(130),h=a(4),_=a(20),y=a(0),x=a(45),C=a.n(x),O=a(117),T=a(122),E=a(99),w=a(75),j=a(131),A=a(167),L=a(175),R=(n={},Object(y.a)(n,C.a.TEXTURE_MIN_FILTER,C.a.LINEAR_MIPMAP_LINEAR),Object(y.a)(n,C.a.TEXTURE_MAG_FILTER,C.a.LINEAR),Object(y.a)(n,C.a.TEXTURE_WRAP_S,C.a.CLAMP_TO_EDGE),Object(y.a)(n,C.a.TEXTURE_WRAP_T,C.a.CLAMP_TO_EDGE),n),k=function(e){Object(m.a)(a,e);var t=Object(b.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"getShaders",value:function(){return Object(_.a)(Object(h.a)(a.prototype),"getShaders",this).call(this,{vs:"\n#define SHADER_NAME bitmap-layer-vertex-shader\n\nattribute vec2 texCoords;\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute vec3 instancePickingColors;\n\nvarying vec2 vTexCoord;\n\nvoid main(void) {\n  geometry.worldPosition = positions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTexCoord = texCoords;\n\n  vec4 color = vec4(0.0);\n  DECKGL_FILTER_COLOR(color, geometry);\n}\n",fs:"\n#define SHADER_NAME bitmap-layer-fragment-shader\n\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D bitmapTexture_r;\nuniform sampler2D bitmapTexture_g;\nuniform sampler2D bitmapTexture_b;\n\nvarying vec2 vTexCoord;\n\nuniform float desaturate;\nuniform vec4 transparentColor;\nuniform vec3 tintColor;\nuniform float opacity;\n\n// apply desaturation\nvec3 color_desaturate(vec3 color) {\n  float luminance = (color.r + color.g + color.b) * 0.333333333;\n  return mix(color, vec3(luminance), desaturate);\n}\n\n// apply tint\nvec3 color_tint(vec3 color) {\n  return color * tintColor;\n}\n\n// blend with background color\nvec4 apply_opacity(vec3 color, float alpha) {\n  return mix(transparentColor, vec4(color, 1.0), alpha);\n}\n\nvoid main(void) {\n  float r_band = texture2D(bitmapTexture_r, vTexCoord).r;\n  float g_band = texture2D(bitmapTexture_g, vTexCoord).r;\n  float b_band = texture2D(bitmapTexture_b, vTexCoord).r;\n  vec4 image = vec4(r_band, g_band, b_band, 1.);\n\n  gl_FragColor = apply_opacity(color_tint(color_desaturate(image.rgb)), image.a * opacity);\n\n  geometry.uv = vTexCoord;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[O.a,T.a]})}},{key:"initializeState",value:function(){this.getAttributeManager().add({positions:{size:3,type:C.a.DOUBLE,fp64:this.use64bitPositions(),update:this.calculatePositions,noAlloc:!0}}),this.setState({numInstances:1,positions:new Float64Array(12)})}},{key:"updateState",value:function(e){var t=e.props,a=e.oldProps;if(e.changeFlags.extensionsChanged){var n=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(n)}),this.getAttributeManager().invalidateAll()}if(!function(e,t){if(!e||!t)return!1;return e.length===t.length&&e.every((function(e,a){return e===t[a]}))}(t.images,a.images)&&t.images){var r=this.context.gl;this.setState({r:new w.a(r,{data:t.images[0],parameters:R}),g:new w.a(r,{data:t.images[1],parameters:R}),b:new w.a(r,{data:t.images[2],parameters:R})})}var o=this.getAttributeManager();t.bounds!==a.bounds&&o.invalidate("positions")}},{key:"finalizeState",value:function(){Object(_.a)(Object(h.a)(a.prototype),"finalizeState",this).call(this),this.state.r&&this.state.r.delete(),this.state.g&&this.state.g.delete(),this.state.b&&this.state.b.delete()}},{key:"calculatePositions",value:function(e){var t=this.state.positions,a=this.props.bounds;if(Number.isFinite(a[0]))t[0]=a[0],t[1]=a[1],t[2]=0,t[3]=a[0],t[4]=a[3],t[5]=0,t[6]=a[2],t[7]=a[3],t[8]=0,t[9]=a[2],t[10]=a[1],t[11]=0;else for(var n=0;n<a.length;n++)t[3*n+0]=a[n][0],t[3*n+1]=a[n][1],t[3*n+2]=a[n][2]||0;e.value=t}},{key:"_getModel",value:function(e){return e?new j.a(e,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new A.a({drawMode:C.a.TRIANGLE_FAN,vertexCount:4,attributes:{texCoords:new Float32Array([0,1,0,0,1,0,1,1])}}),isInstanced:!1})):null}},{key:"draw",value:function(e){var t=e.uniforms,a=this.state,n=a.r,r=a.g,o=a.b,i=a.model,s=this.props,l=s.desaturate,c=s.transparentColor,u=s.tintColor;n&&r&&o&&i&&i.setUniforms(Object.assign({},t,{bitmapTexture_r:n,bitmapTexture_g:r,bitmapTexture_b:o,desaturate:l,transparentColor:c.map((function(e){return e/255})),tintColor:u.slice(0,3).map((function(e){return e/255}))})).draw()}},{key:"loadTextures",value:function(e){return e.every((function(e){return e instanceof w.a}))?e:e?Object(L.a)(3,(function(t){return e[t]})):void 0}}]),a}(E.a);k.layerName="BandsBitmapLayer",k.defaultProps={images:{type:"array",value:[null],compare:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]}};var S=a(170),P=a(172),D={longitude:-112.1861,latitude:36.1284,zoom:12.1,pitch:0,bearing:0},I=function(e){Object(m.a)(a,e);var t=Object(b.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={r_img:null,g_img:null,b_img:null},e}return Object(p.a)(a,[{key:"componentDidMount",value:function(){var e=Object(u.a)(c.a.mark((function e(){var t,a,n,r,o,i,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(t="https://landsat-lambda.kylebarron.dev/tiles/229bc0ed88ac7f39effdb554efa0959766e41bb3948754faba13f74f/12/771/1606@2x.png?bands={band}&color_ops=gamma+R+3.5%2C+sigmoidal+R+15+0.35").replace("{band}","4"),n=t.replace("{band}","3"),r=t.replace("{band}","2"),e.next=6,Object(P.a)(a,S.a);case 6:return o=e.sent,e.next=9,Object(P.a)(n,S.a);case 9:return i=e.sent,e.next=12,Object(P.a)(r,S.a);case 12:s=e.sent,this.setState({r_img:o,g_img:i,b_img:s});case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.r_img,a=e.g_img,n=e.b_img;console.log([t,a,n]);var r=[new f.a({data:"https://landsat-lambda.kylebarron.dev/tiles/229bc0ed88ac7f39effdb554efa0959766e41bb3948754faba13f74f/{z}/{x}/{y}@2x.png?bands=&color_ops=gamma+R+3.5%2C+sigmoidal+R+15+0.35",minZoom:0,maxZoom:12,getTileData:function(){var e=Object(u.a)(c.a.mark((function e(t){var a,n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.url,n=[a.replace("bands=","bands=4"),a.replace("bands=","bands=3"),a.replace("bands=","bands=2")],e.next=4,Promise.all([Object(P.a)(n[0],S.a),Object(P.a)(n[1],S.a),Object(P.a)(n[2],S.a)]);case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),renderSubLayers:function(e){var t,a,n,r=e.tile.bbox,o=r.west,i=r.south,s=r.east,l=r.north,c=e.data;return Array.isArray(c)?(t=c[0],a=c[1],n=c[2]):c&&(t=c.then((function(e){return e&&e[0]})),a=c.then((function(e){return e&&e[1]})),n=c.then((function(e){return e&&e[2]}))),new k(e,{data:null,images:[t,a,n],bounds:[o,i,s,l]})}})];return o.a.createElement(g.a,{initialViewState:D,layers:r,controller:!0},o.a.createElement(v.a,{mapStyle:"https://cdn.jsdelivr.net/gh/nst-guide/osm-liberty-topo@gh-pages/style.json",mapOptions:{hash:!0}}))}}]),a}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(I,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[144,1,2]]]);
//# sourceMappingURL=main.dd09d7d8.chunk.js.map