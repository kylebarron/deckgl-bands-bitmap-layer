(this.webpackJsonpsite=this.webpackJsonpsite||[]).push([[0],{112:function(e,t){},148:function(e,t,n){e.exports=n(160)},153:function(e,t,n){},156:function(e,t){},160:function(e,t,n){"use strict";n.r(t);var a,r=n(9),o=n.n(r),i=n(129),s=n.n(i),l=(n(153),n(14)),c=n.n(l),u=n(27),d=n(2),p=n(1),m=n(92),b=n(6),g=n(175),v=n(177),f=n(135),h=n(3),y=n(20),_=n(0),x=n(45),C=n.n(x),T=n(121),E=n(126),O=n(102),w=n(76),j=n(104),A=n(132),L=n(179),R=(a={},Object(_.a)(a,C.a.TEXTURE_MIN_FILTER,C.a.LINEAR_MIPMAP_LINEAR),Object(_.a)(a,C.a.TEXTURE_MAG_FILTER,C.a.LINEAR),Object(_.a)(a,C.a.TEXTURE_WRAP_S,C.a.CLAMP_TO_EDGE),Object(_.a)(a,C.a.TEXTURE_WRAP_T,C.a.CLAMP_TO_EDGE),a),k=function(e){Object(b.a)(n,e);var t=Object(m.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"getShaders",value:function(){return Object(y.a)(Object(h.a)(n.prototype),"getShaders",this).call(this,{vs:"\n#define SHADER_NAME bitmap-layer-vertex-shader\n\nattribute vec2 texCoords;\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute vec3 instancePickingColors;\n\nvarying vec2 vTexCoord;\n\nvoid main(void) {\n  geometry.worldPosition = positions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTexCoord = texCoords;\n\n  vec4 color = vec4(0.0);\n  DECKGL_FILTER_COLOR(color, geometry);\n}\n",fs:"\n#define SHADER_NAME bitmap-layer-fragment-shader\n\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D bitmapTexture_r;\nuniform sampler2D bitmapTexture_g;\nuniform sampler2D bitmapTexture_b;\n\nvarying vec2 vTexCoord;\n\nuniform float desaturate;\nuniform vec4 transparentColor;\nuniform vec3 tintColor;\nuniform float opacity;\n\n// apply desaturation\nvec3 color_desaturate(vec3 color) {\n  float luminance = (color.r + color.g + color.b) * 0.333333333;\n  return mix(color, vec3(luminance), desaturate);\n}\n\n// apply tint\nvec3 color_tint(vec3 color) {\n  return color * tintColor;\n}\n\n// blend with background color\nvec4 apply_opacity(vec3 color, float alpha) {\n  return mix(transparentColor, vec4(color, 1.0), alpha);\n}\n\nvoid main(void) {\n  float r_band = texture2D(bitmapTexture_r, vTexCoord).r;\n  float g_band = texture2D(bitmapTexture_g, vTexCoord).r;\n  float b_band = texture2D(bitmapTexture_b, vTexCoord).r;\n  vec4 image = vec4(r_band, g_band, b_band, 1.);\n\n  gl_FragColor = apply_opacity(color_tint(color_desaturate(image.rgb)), image.a * opacity);\n\n  geometry.uv = vTexCoord;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[T.a,E.a]})}},{key:"initializeState",value:function(){this.getAttributeManager().add({positions:{size:3,type:C.a.DOUBLE,fp64:this.use64bitPositions(),update:this.calculatePositions,noAlloc:!0}}),this.setState({numInstances:1,positions:new Float64Array(12)})}},{key:"updateState",value:function(e){var t=e.props,n=e.oldProps;if(e.changeFlags.extensionsChanged){var a=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(a)}),this.getAttributeManager().invalidateAll()}if(!function(e,t){if(!e||!t)return!1;return e.length===t.length&&e.every((function(e,n){return e===t[n]}))}(t.images,n.images)&&t.images){var r=this.context.gl;this.setState({r:new w.a(r,{data:t.images[0],parameters:R}),g:new w.a(r,{data:t.images[1],parameters:R}),b:new w.a(r,{data:t.images[2],parameters:R})})}var o=this.getAttributeManager();t.bounds!==n.bounds&&o.invalidate("positions")}},{key:"finalizeState",value:function(){Object(y.a)(Object(h.a)(n.prototype),"finalizeState",this).call(this),this.state.r&&this.state.r.delete(),this.state.g&&this.state.g.delete(),this.state.b&&this.state.b.delete()}},{key:"calculatePositions",value:function(e){var t=this.state.positions,n=this.props.bounds;if(Number.isFinite(n[0]))t[0]=n[0],t[1]=n[1],t[2]=0,t[3]=n[0],t[4]=n[3],t[5]=0,t[6]=n[2],t[7]=n[3],t[8]=0,t[9]=n[2],t[10]=n[1],t[11]=0;else for(var a=0;a<n.length;a++)t[3*a+0]=n[a][0],t[3*a+1]=n[a][1],t[3*a+2]=n[a][2]||0;e.value=t}},{key:"_getModel",value:function(e){return e?new j.a(e,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new A.a({drawMode:C.a.TRIANGLE_FAN,vertexCount:4,attributes:{texCoords:new Float32Array([0,1,0,0,1,0,1,1])}}),isInstanced:!1})):null}},{key:"draw",value:function(e){var t=e.uniforms,n=this.state,a=n.r,r=n.g,o=n.b,i=n.model,s=this.props,l=s.desaturate,c=s.transparentColor,u=s.tintColor;a&&r&&o&&i&&i.setUniforms(Object.assign({},t,{bitmapTexture_r:a,bitmapTexture_g:r,bitmapTexture_b:o,desaturate:l,transparentColor:c.map((function(e){return e/255})),tintColor:u.slice(0,3).map((function(e){return e/255}))})).draw()}},{key:"loadTextures",value:function(e){return e.every((function(e){return e instanceof w.a}))?e:e?Object(L.a)(3,(function(t){return e[t]})):void 0}}]),n}(O.a);k.layerName="BandsBitmapLayer",k.defaultProps={images:{type:"array",value:[null],compare:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]}};var S=n(174),P=n(176),I=n(173),D=n(181),M={longitude:-112.1861,latitude:36.1284,zoom:12.1,pitch:0,bearing:0},F=new D.a(I.a,{amount:1}),N=function(e){Object(b.a)(n,e);var t=Object(m.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=[new v.a({data:"https://landsat-lambda.kylebarron.dev/tiles/229bc0ed88ac7f39effdb554efa0959766e41bb3948754faba13f74f/{z}/{x}/{y}@2x.jpg?bands=&color_ops=gamma+R+3.5%2C+sigmoidal+R+15+0.35",minZoom:0,maxZoom:12,getTileData:function(){var e=Object(u.a)(c.a.mark((function e(t){var n,a,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.url,a=[n.replace("bands=","bands=4"),n.replace("bands=","bands=3"),n.replace("bands=","bands=2")],e.next=4,Promise.all([Object(P.a)(a[0],S.a),Object(P.a)(a[1],S.a),Object(P.a)(a[2],S.a)]);case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),renderSubLayers:function(e){var t,n,a,r=e.tile.bbox,o=r.west,i=r.south,s=r.east,l=r.north,c=e.data;return Array.isArray(c)?(t=c[0],n=c[1],a=c[2]):c&&(t=c.then((function(e){return e&&e[0]})),n=c.then((function(e){return e&&e[1]})),a=c.then((function(e){return e&&e[2]}))),new k(e,{data:null,images:[t,n,a],bounds:[o,i,s,l]})}})];return o.a.createElement(g.a,{initialViewState:M,layers:e,effects:[F],controller:!0},o.a.createElement(f.a,{mapStyle:"https://cdn.jsdelivr.net/gh/nst-guide/osm-liberty-topo@gh-pages/style.json",mapOptions:{hash:!0}}))}}]),n}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(N,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[148,1,2]]]);
//# sourceMappingURL=main.5d72df8a.chunk.js.map